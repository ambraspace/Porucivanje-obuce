VERSION 5.00
Begin VB.Form frmNaruci 
   BorderStyle     =   1  'Fixed Single
   Caption         =   "Naruèivanje modela"
   ClientHeight    =   3615
   ClientLeft      =   45
   ClientTop       =   330
   ClientWidth     =   4830
   Icon            =   "frmNaruci.frx":0000
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   3615
   ScaleWidth      =   4830
   ShowInTaskbar   =   0   'False
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   39
      Left            =   4320
      MaxLength       =   2
      TabIndex        =   58
      Text            =   "00"
      Top             =   1770
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   38
      Left            =   3960
      MaxLength       =   2
      TabIndex        =   57
      Text            =   "00"
      Top             =   1770
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   37
      Left            =   3600
      MaxLength       =   2
      TabIndex        =   56
      Text            =   "00"
      Top             =   1770
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   36
      Left            =   3240
      MaxLength       =   2
      TabIndex        =   55
      Text            =   "00"
      Top             =   1770
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   35
      Left            =   2880
      MaxLength       =   2
      TabIndex        =   54
      Text            =   "00"
      Top             =   1770
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   34
      Left            =   2520
      MaxLength       =   2
      TabIndex        =   53
      Text            =   "00"
      Top             =   1770
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   33
      Left            =   2160
      MaxLength       =   2
      TabIndex        =   52
      Text            =   "00"
      Top             =   1770
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   32
      Left            =   1800
      MaxLength       =   2
      TabIndex        =   51
      Text            =   "00"
      Top             =   1770
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   31
      Left            =   1440
      MaxLength       =   2
      TabIndex        =   50
      Text            =   "00"
      Top             =   1770
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   30
      Left            =   1080
      MaxLength       =   2
      TabIndex        =   49
      Text            =   "00"
      Top             =   1770
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   29
      Left            =   4320
      MaxLength       =   2
      TabIndex        =   47
      Text            =   "00"
      Top             =   1500
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   28
      Left            =   3960
      MaxLength       =   2
      TabIndex        =   46
      Text            =   "00"
      Top             =   1500
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   27
      Left            =   3600
      MaxLength       =   2
      TabIndex        =   45
      Text            =   "00"
      Top             =   1500
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   26
      Left            =   3240
      MaxLength       =   2
      TabIndex        =   44
      Text            =   "00"
      Top             =   1500
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   25
      Left            =   2880
      MaxLength       =   2
      TabIndex        =   43
      Text            =   "00"
      Top             =   1500
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   24
      Left            =   2520
      MaxLength       =   2
      TabIndex        =   42
      Text            =   "00"
      Top             =   1500
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   23
      Left            =   2160
      MaxLength       =   2
      TabIndex        =   41
      Text            =   "00"
      Top             =   1500
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   22
      Left            =   1800
      MaxLength       =   2
      TabIndex        =   40
      Text            =   "00"
      Top             =   1500
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   21
      Left            =   1440
      MaxLength       =   2
      TabIndex        =   39
      Text            =   "00"
      Top             =   1500
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   20
      Left            =   1080
      MaxLength       =   2
      TabIndex        =   38
      Text            =   "00"
      Top             =   1500
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   19
      Left            =   4320
      MaxLength       =   2
      TabIndex        =   36
      Text            =   "00"
      Top             =   1230
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   18
      Left            =   3960
      MaxLength       =   2
      TabIndex        =   35
      Text            =   "00"
      Top             =   1230
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   17
      Left            =   3600
      MaxLength       =   2
      TabIndex        =   34
      Text            =   "00"
      Top             =   1230
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   16
      Left            =   3240
      MaxLength       =   2
      TabIndex        =   33
      Text            =   "00"
      Top             =   1230
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   15
      Left            =   2880
      MaxLength       =   2
      TabIndex        =   32
      Text            =   "00"
      Top             =   1230
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   14
      Left            =   2520
      MaxLength       =   2
      TabIndex        =   31
      Text            =   "00"
      Top             =   1230
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   13
      Left            =   2160
      MaxLength       =   2
      TabIndex        =   30
      Text            =   "00"
      Top             =   1230
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   12
      Left            =   1800
      MaxLength       =   2
      TabIndex        =   29
      Text            =   "00"
      Top             =   1230
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   11
      Left            =   1440
      MaxLength       =   2
      TabIndex        =   28
      Text            =   "00"
      Top             =   1230
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   10
      Left            =   1080
      MaxLength       =   2
      TabIndex        =   27
      Text            =   "00"
      Top             =   1230
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.CommandButton cmNaruci 
      Caption         =   "Zapamti"
      Default         =   -1  'True
      Height          =   375
      Left            =   3360
      TabIndex        =   61
      ToolTipText     =   "Naruèi ovaj model"
      Top             =   3120
      Width           =   1335
   End
   Begin VB.CommandButton cmdCancel 
      Cancel          =   -1  'True
      Caption         =   "Poništi"
      Height          =   375
      Left            =   120
      TabIndex        =   62
      ToolTipText     =   "Poništi narudžbu za ovaj model"
      Top             =   3120
      Width           =   1335
   End
   Begin VB.TextBox txtComment 
      Height          =   285
      Left            =   120
      MaxLength       =   255
      TabIndex        =   60
      ToolTipText     =   "Dodatni zahtjevi i komentar"
      Top             =   2760
      Width           =   4575
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   9
      Left            =   4320
      MaxLength       =   2
      TabIndex        =   11
      Text            =   "00"
      Top             =   960
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   8
      Left            =   3960
      MaxLength       =   2
      TabIndex        =   10
      Text            =   "00"
      Top             =   960
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   7
      Left            =   3600
      MaxLength       =   2
      TabIndex        =   9
      Text            =   "00"
      Top             =   960
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   6
      Left            =   3240
      MaxLength       =   2
      TabIndex        =   8
      Text            =   "00"
      Top             =   960
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   5
      Left            =   2880
      MaxLength       =   2
      TabIndex        =   7
      Text            =   "00"
      Top             =   960
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   4
      Left            =   2520
      MaxLength       =   2
      TabIndex        =   6
      Text            =   "00"
      Top             =   960
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   3
      Left            =   2160
      MaxLength       =   2
      TabIndex        =   5
      Text            =   "00"
      Top             =   960
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   2
      Left            =   1800
      MaxLength       =   2
      TabIndex        =   4
      Text            =   "00"
      Top             =   960
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   1
      Left            =   1440
      MaxLength       =   2
      TabIndex        =   3
      Text            =   "00"
      Top             =   960
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.TextBox txtKolicina 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      Height          =   285
      Index           =   0
      Left            =   1080
      MaxLength       =   2
      TabIndex        =   2
      Text            =   "00"
      Top             =   960
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.Label lblBoja 
      Alignment       =   1  'Right Justify
      Caption         =   "boja1:"
      Height          =   255
      Index           =   3
      Left            =   120
      TabIndex        =   59
      Top             =   1785
      Visible         =   0   'False
      Width           =   855
   End
   Begin VB.Label lblBoja 
      Alignment       =   1  'Right Justify
      Caption         =   "boja1:"
      Height          =   255
      Index           =   2
      Left            =   120
      TabIndex        =   48
      Top             =   1515
      Visible         =   0   'False
      Width           =   855
   End
   Begin VB.Label lblBoja 
      Alignment       =   1  'Right Justify
      Caption         =   "boja1:"
      Height          =   255
      Index           =   1
      Left            =   120
      TabIndex        =   37
      Top             =   1245
      Visible         =   0   'False
      Width           =   855
   End
   Begin VB.Label lblUkupno 
      Caption         =   "0"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   238
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Left            =   1080
      TabIndex        =   26
      ToolTipText     =   "Ukupno pari"
      Top             =   2160
      Width           =   735
   End
   Begin VB.Label Label6 
      Caption         =   "Dodatni komentar:"
      Height          =   255
      Left            =   120
      TabIndex        =   25
      Top             =   2520
      Width           =   1455
   End
   Begin VB.Label Label5 
      Alignment       =   1  'Right Justify
      Caption         =   "Ukupno:"
      Height          =   255
      Left            =   120
      TabIndex        =   24
      Top             =   2160
      Width           =   855
   End
   Begin VB.Label lblBoja 
      Alignment       =   1  'Right Justify
      Caption         =   "boja1:"
      Height          =   255
      Index           =   0
      Left            =   120
      TabIndex        =   23
      Top             =   975
      Visible         =   0   'False
      Width           =   855
   End
   Begin VB.Label Label3 
      Alignment       =   1  'Right Justify
      Caption         =   "Brojevi (fr.):"
      Height          =   255
      Left            =   120
      TabIndex        =   22
      Top             =   720
      Width           =   855
   End
   Begin VB.Label lblBroj 
      Alignment       =   2  'Center
      Caption         =   "00"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   238
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Index           =   9
      Left            =   4320
      TabIndex        =   21
      Top             =   720
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.Label lblBroj 
      Alignment       =   2  'Center
      Caption         =   "00"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   238
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Index           =   8
      Left            =   3960
      TabIndex        =   20
      Top             =   720
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.Label lblBroj 
      Alignment       =   2  'Center
      Caption         =   "00"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   238
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Index           =   7
      Left            =   3600
      TabIndex        =   19
      Top             =   720
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.Label lblBroj 
      Alignment       =   2  'Center
      Caption         =   "00"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   238
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Index           =   6
      Left            =   3240
      TabIndex        =   18
      Top             =   720
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.Label lblBroj 
      Alignment       =   2  'Center
      Caption         =   "00"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   238
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Index           =   5
      Left            =   2880
      TabIndex        =   17
      Top             =   720
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.Label lblBroj 
      Alignment       =   2  'Center
      Caption         =   "00"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   238
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Index           =   4
      Left            =   2520
      TabIndex        =   16
      Top             =   720
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.Label lblBroj 
      Alignment       =   2  'Center
      Caption         =   "00"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   238
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Index           =   3
      Left            =   2160
      TabIndex        =   15
      Top             =   720
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.Label lblBroj 
      Alignment       =   2  'Center
      Caption         =   "00"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   238
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Index           =   2
      Left            =   1800
      TabIndex        =   14
      Top             =   720
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.Label lblBroj 
      Alignment       =   2  'Center
      Caption         =   "00"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   238
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Index           =   1
      Left            =   1440
      TabIndex        =   13
      Top             =   720
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.Label lblBroj 
      Alignment       =   2  'Center
      Caption         =   "00"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   238
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Index           =   0
      Left            =   1080
      TabIndex        =   12
      Top             =   720
      Visible         =   0   'False
      Width           =   375
   End
   Begin VB.Line Line1 
      X1              =   120
      X2              =   4680
      Y1              =   480
      Y2              =   480
   End
   Begin VB.Label lblModel 
      Caption         =   "Boreli MS-6589"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   238
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Left            =   1920
      TabIndex        =   1
      ToolTipText     =   "Model koji naruèujete"
      Top             =   120
      Width           =   2775
   End
   Begin VB.Label Label1 
      Alignment       =   1  'Right Justify
      Caption         =   "Naruèujete model:"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   238
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Left            =   120
      TabIndex        =   0
      Top             =   120
      Width           =   1695
   End
End
Attribute VB_Name = "frmNaruci"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
Private lCurrentModel As Long
Private bPostojiNarudžba As Boolean

Private Sub cmdCancel_Click()
If bPostojiNarudžba Then
    cNarudzbe.Remove "ID" & cModeli(lCurrentModel).ModelID
End If

If Me.txtKolicina(0).Visible Then
    Me.txtKolicina(0).SetFocus
Else
    Me.txtComment.SetFocus
End If
Me.Hide
frmGlavni.LoadModel
End Sub

Private Sub cmNaruci_Click()
Dim c As New cNarudzba, sNB As String, i As Integer, bNarudzbaOK As Boolean
c.ModelID = cModeli(lCurrentModel).ModelID
c.NarudzbaComment = Trim(Me.txtComment)

For i = 0 To 39
    If Me.txtKolicina(i).Visible And Val(Me.txtKolicina(i)) > 0 Then
        sNB = sNB & Val(Me.txtKolicina(i)) & "|"
        bNarudzbaOK = True
    Else
        sNB = sNB & "0|"
    End If
Next

sNB = Left(sNB, Len(sNB) - 1)
c.NarudzbaBroj = sNB

If bPostojiNarudžba Then
    cNarudzbe.Remove "ID" & cModeli(lCurrentModel).ModelID
End If
If bNarudzbaOK Or c.NarudzbaComment <> "" Then
    cNarudzbe.Add c, "ID" & cModeli(lCurrentModel).ModelID
End If
    
Set c = Nothing
If Me.txtKolicina(0).Visible Then
    Me.txtKolicina(0).SetFocus
Else
    Me.txtComment.SetFocus
End If
Me.Hide
frmGlavni.LoadModel
End Sub

Private Sub Form_Load()
Me.Top = frmGlavni.Top + frmGlavni.cmdNaruci.Top + frmGlavni.cmdNaruci.Height  '+ frmGlavni.Height
Me.Left = frmGlavni.Left + frmGlavni.Width - Me.Width
End Sub

Private Sub txtKolicina_Change(Index As Integer)
Dim i As Integer, lCount As Long
For i = 0 To 39
    If Me.txtKolicina(i).Visible Then lCount = lCount + Val(Me.txtKolicina(i))
Next

Me.lblUkupno = lCount
        
End Sub

Private Sub txtKolicina_GotFocus(Index As Integer)
Me.txtKolicina(Index).SelStart = 0
Me.txtKolicina(Index).SelLength = Len(Me.txtKolicina(Index))
End Sub

Public Sub Display(b As Boolean)
Dim sNBS(39) As Integer, sTMP As String, iCount As Integer, i As Integer, lPari As Long
Dim cModelTMP As cModel
lCurrentModel = Val(frmGlavni.Tag)
bPostojiNarudžba = b

Set cModelTMP = cModeli(lCurrentModel)
Me.lblModel = cModelTMP.Model

GetSortiment

If bPostojiNarudžba Then
    sTMP = cNarudzbe("ID" & cModelTMP.ModelID).NarudzbaBroj
Opet:
    If InStr(sTMP, "|") = 0 Then
        sNBS(iCount) = Val(sTMP)
    Else
        sNBS(iCount) = Val(Left(sTMP, InStr(sTMP, "|") - 1))
        sTMP = Mid(sTMP, InStr(sTMP, "|") + 1)
        iCount = iCount + 1
        GoTo Opet
    End If
    
    For i = 0 To 39
        If sNBS(i) > 0 Then
            Me.txtKolicina(i) = sNBS(i)
            lPari = lPari + sNBS(i)
        End If
    Next
    
    Me.lblUkupno = lPari
    
    Me.txtComment = cNarudzbe("ID" & cModelTMP.ModelID).NarudzbaComment
End If
Me.Show 1, frmGlavni
End Sub

Private Sub GetSortiment()
Dim sSort As String, sBoja As String, i As Integer, sTMP As String, iPoljeCount As Integer, s As String, iZnakCount As Integer

For i = 0 To 9
    Me.lblBroj(i).Visible = False
    Me.txtKolicina(4 * i).Visible = False
    Me.txtKolicina(4 * i) = ""
    Me.txtKolicina(4 * i + 1).Visible = False
    Me.txtKolicina(4 * i + 1) = ""
    Me.txtKolicina(4 * i + 2).Visible = False
    Me.txtKolicina(4 * i + 2) = ""
    Me.txtKolicina(4 * i + 3).Visible = False
    Me.txtKolicina(4 * i + 3) = ""
Next
Me.txtComment = ""

For i = 0 To 3
    Me.lblBoja(i).Visible = False
Next

Me.lblUkupno = "0"

sBoja = cModeli(lCurrentModel).Boja
sSort = cModeli(lCurrentModel).Sortiment

PostaviBoje sBoja

Dim sBrojevi() As Integer, sZnakovi() As String, bZnakoviOK As Boolean, bBrojeviOK As Boolean
' ako dužina polja nije 2,5,8 itd. izlazi iz funkcije
If (Len(sSort) + 1) Mod 3 <> 0 Then GoTo greška
ReDim sBrojevi(((Len(sSort) + 1) / 3) - 1)
' popunjava brojeve
For i = 0 To UBound(sBrojevi)
    If Mid(sSort, 3 * i + 1, 2) <> CStr(Val(Mid(sSort, 3 * i + 1, 2))) Then
        GoTo greška
    Else
        sBrojevi(i) = Val(Mid(sSort, 3 * i + 1, 2))
    End If
Next
'popunjava znakove
If Len(sSort) > 4 Then
    ReDim sZnakovi(UBound(sBrojevi) - 1)
    For i = 0 To UBound(sZnakovi)
        sZnakovi(i) = Mid(sSort, (i + 1) * 3, 1)
        If sZnakovi(i) <> "-" And sZnakovi(i) <> "," Then GoTo greška
    Next
    
    If UBound(sZnakovi) = 0 Then
        bZnakoviOK = True
        GoTo n1
    End If
    bZnakoviOK = True
    For i = 0 To UBound(sZnakovi) - 1
        If sZnakovi(i) = "-" And sZnakovi(i + 1) = "-" Then GoTo greška
    Next
Else
    bZnakoviOK = True
End If

n1:
If UBound(sBrojevi) = 0 Then
    bBrojeviOK = True
Else
    bBrojeviOK = True
    For i = 0 To UBound(sBrojevi) - 1
        If sBrojevi(i) >= sBrojevi(i + 1) Then GoTo greška
    Next
End If

If bBrojeviOK And bZnakoviOK Then
    Select Case UBound(sBrojevi)
        Case 0
            Me.lblBroj(0) = sBrojevi(0)
            Me.lblBroj(0).Visible = True
        Case Is > 0
            iPoljeCount = 0
            iZnakCount = 0
t1:
            If sZnakovi(iZnakCount) = "," Then
                Me.lblBroj(iPoljeCount) = sBrojevi(iZnakCount)
                Me.lblBroj(iPoljeCount).Visible = True
                iPoljeCount = iPoljeCount + 1
                If UBound(sZnakovi) > iZnakCount Then
                    iZnakCount = iZnakCount + 1
                    GoTo t1
                Else
                    Me.lblBroj(iPoljeCount) = sBrojevi(iZnakCount + 1)
                    Me.lblBroj(iPoljeCount).Visible = True
                End If
            Else
                For i = sBrojevi(iZnakCount) To sBrojevi(iZnakCount + 1)
                    Me.lblBroj(iPoljeCount) = i
                    Me.lblBroj(iPoljeCount).Visible = True
                    iPoljeCount = iPoljeCount + 1
                Next
                If UBound(sZnakovi) > (iZnakCount + 1) Then
                    iZnakCount = iZnakCount + 2
                    GoTo t1
                ElseIf UBound(sZnakovi) = (iZnakCount + 1) Then
                    Me.lblBroj(iPoljeCount) = sBrojevi(iZnakCount + 2)
                    Me.lblBroj(iPoljeCount).Visible = True
                End If
            End If
    End Select
Else
    GoTo greška
End If

For i = 0 To 39
    If Me.lblBroj(i Mod 10).Visible And Me.lblBoja(Int(i / 10)).Visible Then Me.txtKolicina(i).Visible = True
Next
Exit Sub

greška:
MsgBox "NEISPRAVAN SORTIMENT!!!" & vbCrLf & _
        "U polje ""Dodatni komentar:"" upišite svoju narudžbu.", vbCritical + vbOKOnly, "Poruèivanje obuæe"

End Sub


Private Sub PostaviBoje(sInput As String)
Dim sBoja(3) As String, sTMP As String, iCount As Integer, i As Integer

iCount = 0
sTMP = sInput

Opet:

If InStr(sTMP, ",") = 0 Then
    sBoja(iCount) = sTMP
Else
    sBoja(iCount) = Left(sTMP, InStr(sTMP, ",") - 1)
    If iCount = 3 Then GoTo Over
    iCount = iCount + 1
    sTMP = Mid(sTMP, InStr(sTMP, ",") + 1)
    GoTo Opet
End If
    
Over:
For i = 0 To iCount
    Me.lblBoja(i).Caption = sBoja(i) & ":"
    Me.lblBoja(i).Visible = True
Next

Me.Label5.Top = Me.lblBoja(iCount).Top + Me.lblBoja(iCount).Height + 105
Me.lblUkupno.Top = Me.Label5.Top
Me.Label6.Top = Me.lblUkupno.Top + Me.lblUkupno.Height + 105
Me.txtComment.Top = Me.Label6.Top + Me.Label6.Height - 15
Me.cmdCancel.Top = Me.txtComment.Top + Me.txtComment.Height + 120
Me.cmNaruci.Top = Me.cmdCancel.Top

Me.Height = 3990 - (3 - iCount) * 270

End Sub

Private Sub txtKolicina_KeyDown(Index As Integer, KeyCode As Integer, Shift As Integer)
If Shift <> 0 Then Exit Sub
Select Case KeyCode
    Case vbKeyRight
        If Index Mod 10 < 9 Then
            If Me.txtKolicina(Index + 1).Visible Then Me.txtKolicina(Index + 1).SetFocus
        End If
    Case vbKeyLeft
        If Index Mod 10 > 0 Then
            If Me.txtKolicina(Index - 1).Visible Then Me.txtKolicina(Index - 1).SetFocus
        End If
    Case vbKeyDown
        If Index < 30 Then
            If Me.txtKolicina(Index + 10).Visible Then Me.txtKolicina(Index + 10).SetFocus
        End If
    Case vbKeyUp
        If Index > 9 Then
            If Me.txtKolicina(Index - 10).Visible Then Me.txtKolicina(Index - 10).SetFocus
        End If
End Select
End Sub

Private Sub txtKolicina_KeyPress(Index As Integer, KeyAscii As Integer)
If (KeyAscii < 48 Or KeyAscii > 57) And KeyAscii <> 8 Then
    KeyAscii = 0
    Beep
End If
End Sub



